# Conan build pipeline
name: demo-led-status-indication build pipeline
pool:
  name: AZP-006_Raspberrypi_tool

steps:
- script: |
    pwd
    conan config install conanconfig
    conan remote list
    conan user
    conan create . swf/latest --build=demo-led-status-indication -pr=swf_ubuntu16_x64_gcc5
    conan create . swf/latest --build=demo-led-status-indication -pr=swf_linux_to_arm_raspi
  displayName: 'Building via Conan'

- script: |
    cd $(Build.ArtifactStagingDirectory)
    pwd
    conan install demo-led-status-indication/1.0.0@swf/latest -pr=swf_ubuntu16_x64_gcc5 -g virtualrunenv
    conan install demo-led-status-indication/1.0.0@swf/latest -pr=swf_linux_to_arm_raspi -g virtualrunenv
    source activate_run.sh
    ./bin/demo-led-status-indication.Linux.x86_64

    chmod 777 run.sh
    cat run.sh
    ./run.sh
#    ./run.sh --version
  displayName: 'Testing executables'
